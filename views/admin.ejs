<!DOCTYPE html>
<html lang="en">
<%- include('header.ejs') %>
<script src="/js/script.js"></script>
<body>
<%- include('navbar.ejs') %>

<main class="container text-left">
    <div class="container">
    <%
    switch (res) {
    case "editCar": %>
        <h6 class="classified"> The vehicle was <strong> edited </strong> successfully.</h6>
    <% break;
    case "editRes": %>
        <h6 class="classified"> The reservation was <strong> edited </strong> successfully.</h6>
    <% break;
    case "rem":%>
        <h6 class="classified"> The reservation was <strong> removed </strong> successfully.</h6>
    <% break;
    case "editUse":%>
        <h6 class="classified"> The user was <strong> edited </strong> successfully.</h6>
    <% break;
    } %>

    <%if ((car === undefined || car === null)
        && (resv === undefined || resv === null)
        && (userData === undefined || userData === null)) {%>

        <ul class="nav nav-tabs" role="tablist">
            <li id="cars" class="nav-link active">Vehicles</li>
            <li id="resvs" class="nav-link">Reservations</li>
            <li id="users" class="nav-link">Users</li>
        </ul>
    <% } %>

    <div id="cars1" class="hide">
    <%if (carsArr !== undefined && carsArr !== null) { %>
    <div class="cars_container">
    <div class="card-deck-wrapper">
    <div class="card-deck">

    <% carsArr.forEach( (car) => { %>
    <div class="card text-center">
    <img class="card-img-top img-fluid mx-auto d-block" src="/<%= car.photo %>"
         alt="<%= car.model + " " + ' image' %>">
    <div class="card-body d-flex flex-column">
        <p class="card-text">
        <strong> <i> <%= car.model %> </i> </strong>
    <br>
        <a href="/data/<%= car.brand %> %>"><%= car.brand %></a>
    <br>
        <i class="w-0 p-0"><%= car.year%></i>
        </p>
        <a href="<%= '/admin/car/'+ car.idCar %>" class="btn btn-success btn-block mt-auto"> More </a>
    </div>
    </div>
    <% })%>

    </div>
    </div>
    </div>
    <% } %>
    </div>

    <div id="resvs1" class="hide">
    <%if (resArr !== undefined && resArr !== null) { %>
    <div class="cars_container">
    <div class="card-deck-wrapper">
    <div class="card-deck">

    <% resArr.forEach( (res) => { %>
    <div class="card text-center">
    <img class="card-img-top img-fluid mx-auto d-block" src="/<%= res.photo %>"
         alt="<%= res.model + " " + ' image' %>">
    <div class="card-body d-flex flex-column">
        <p class="card-text">
        <a href="/vehicle/<%= res.idCar %> %>"><%= res.model %> </a>
    <br>
        <strong> <i> <%= res.fullPrice %> &#36;</i></strong>
    <br>
        <i class="w-0 p-0"><%=  new Date(res.dateIn).toDateString()+' - '+new Date(res.dateOut).toDateString()%></i>
        </p>
        <a href="<%= '/admin/resv/'+ res.idReservation %>" class="btn btn-primary btn-block mt-auto"> More </a>
    </div>
    </div>
    <% })%>

    </div>
    </div>
    </div>

    <% } //---------- NOT WORKING
    else { %>
    <br>
    <h4> There are no <strong> reservations </strong>.</h4>
    <% } %>
    </div>

    <div id="users1" class="hide">
    <%if (userArr !== undefined && userArr !== null) { %>
    <div class="cars_container">
    <div class="card-deck-wrapper">
    <div class="card-deck">

    <% userArr.forEach( (use) => { %>
    <div class="card text-center">
    <div class="card-body d-flex flex-column">
        <p class="card-text">
        <strong> <i> <%= use.fullName %> </i> </strong>
    <br>
        <a><%= use.idUser %></a>
    <br>
        </p>
        <a href="<%= '/admin/user/'+ use.idUser %>" class="btn btn-danger btn-block mt-auto"> More </a>
    </div>
    </div>
    <% })%>

    </div>
    </div>
    </div>
    <% } %>
    </div>
    </div>

    <div class="container row book_container" style="margin: auto;">
    <%if (car !== undefined && car !== null) { %>
    <div class="col-md-5">
    <img class="img-fluid mx-auto d-block" src="/<%= car.photo %>" alt="book cover">
    </div>

    <div id="car_info" class="col-sm-7 text-left card ">
    <form action="/admin/editCar/<%= car.idCar%>" method="post">

    <div class="form-group">
        <label><%= car.brand %>:
        <input type="text" class="form-control col-md-10" maxlength="20" name="model" value="<%= car.model%>" required>
        </label>
    </div>

    <div class="form-group">
    <label>Brand:
        <select class="selectpicker form-control" data-style="btn-info" name="brand" required>
        <% slctArr.forEach(function(slct){ %>
        <option value="<%= slct.name %>"><%= slct.name %></option>
        <% }) %>
        </select>
    </label>
    </div>

    <div class="form-group">
    <label>Category:
        <select class="selectpicker form-control" data-style="btn-info" name="type" required>
        <% slct1Arr.forEach(function(slct1){ %>
        <option value="<%= slct1.type %>"><%= slct1.type %></option>
        <% }) %>
        </select>
    </label>
    </div>

    <div class="form-group">
    <label> Production:</label>
    <input type="number" class="form-control" name="year" value="<%= car.year %>" style="width:15%;" required>
    </div>

    <div class="form-group">
    <label> Price (<i>&#36;</i>):
    <input type="number" class="form-control col-md-5" name="price" value="<%= car.price %>" required>
    </label>
    </div>

    <div class="form-group">
    <label>Active:
        <select class="form-control" name="active">
        <option value="1" selected>Yes</option>
        <option value="0">No</option>
        </select>
    </label>
    </div>

    <hr>

    <div class="synopsis text-justify">
        <%= car.details %>
    </div>

    <br>

    <button class="btn btn-success btn-block btn-sm col-md-12">Change</button>
    </form>
    </div>
    <% } %>

    <%if (resv !== undefined && resv !== null) { %>
    <div class="col-md-5">
    <img class="img-fluid mx-auto d-block" src="/<%= resv.photo %>" alt="book cover">
    </div>

    <div id="car_info" class="col-md-5 text-left card ">
    <div class="title">
    <strong> <i> <%= resv.brand %> <%= resv.model %> </i> </strong>
    </div>

    <div class="category"> User:
    <a href="/admin/user/<%= resv.idUser %>">
        <%= resv.fullName %>
    </a>
    </div>

    <div class="category"> Category:
    <a href="/data/<%= resv.type %>">
        <%= resv.type %>
    </a>
    </div>

    <div class="price"> Price:
    <a>
        <%= resv.fullPrice %><i>&#36;</i>
    </a>
    </div>

    <div class="price"> From
    <i><%=  new Date(resv.dateIn).toDateString() +' '%></i> to <i> <%=' '+ new Date(resv.dateOut).toDateString()%></i>
    </div>

    <br>
    <hr>

    <form action="/admin/editRes/<%= resv.idReservation%>" method="post">
    <div class="form-group"><label>Date in: </label><span> &ensp; &ensp;</span><input id="dateIn" class="date form-control" type="date" name="dateIn" required><br></div>
    <div class="form-group"><label>Date out: </label><span> &ensp; </span><input id="dateOut" class="date form-control" type="date" name="dateOut" readonly required></div>

    <div class="form-group">
    <label>Active:
        <select class="form-control" name="active">
        <option value="1" selected>Yes</option>
        <option value="0">No</option>
        </select>
    </label>
    </div>

    <div class="form-group"><input id="days" type="range" class="custom-range form-control" name="days" min="1" max="6" value="1"></div>
    <input id="price" type="hidden" value="<%= resv.price %>">

    <br>
    <br>

    <div class="form-group">
        <label>Full price:</label><span> &ensp; &ensp;</span>
        <input id="numbers" class="col-md-3" size="1" name="numbers" readonly value="<%= resv.price %>"> <i>&#36;</i>
    </div>

    <button class="btn btn-primary btn-block btn-sm"> Edit</button>
    </form>

    <br>

    <form action="<%= '/admin/rem/'+ resv.idReservation%>" method="post">
    <button class="btn btn-danger btn-block btn-sm"> Remove</button>
    </form>
    </div>
    <% } %>

    <%if (userData !== undefined && userData !== null) { %>
    <div class="col-md-10 text-center" style="margin:auto;">
    <i class="fa fa-user fa-4x"></i>
    </div>

    <hr>

    <div id="car_info" class="col-md-9 text-left card" style="margin:auto;">
    <form action="/admin/editUse/<%= userData.idUser%>" method="post">

    <div class="form-group">
    <label>Full Name:</label>
    <input type="text" size="14" maxlength="20" class="form-control" value="<%= userData.fullName %>" name="name" required>
    </div>

    <div class="form-group">
    <label>E-mail:</label>
    <input type="email" class="form-control" value="<%= userData.email %>" name="email" required>
    </div>

    <div class="form-group">
    <label>Active:
    <select class="form-control" name="active">
        <option value="1" selected>Yes</option>
        <option value="0">No</option>
    </select>
    </label>

    <label>Admin:
    <select class="form-control" name="admin">
        <option value="0" selected>No</option>
        <option value="1">Yes</option>
    </select>
    </label>
    </div>

    <button class="btn btn-danger btn-block btn-sm col-sm-12"> Edit</button>
    </form>
    </div>
    <% } %>

</div>
</main>
<%- include('footer.ejs') %>
</body>
</html>