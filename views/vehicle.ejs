<!DOCTYPE html>
<html lang="en">

<%- include('header.ejs') %>

<body class="container shadow bg">

<%- include('navbar.ejs') %>

<main class="container" role="main">
  <div class="row car_container">

  <div class="col">
  <img class="img-fluid"
    src="/<%= car.photo %>" alt="<%= car.model %> image">
  <%if (user) { %>
    <%if (!resv) { %>
    <form action="/vehicle/add/<%= car.idCar %>" method="post">
      <div class="form-group">
      <label>Date in:
          <input id="dateIn" class="date form-control"
            type="date" name="dateIn" required>
      </label>
      </div>

      <div class="form-group">
      <label>Date out:
        <input id="dateOut" class="date form-control"
          type="date" name="dateOut" readonly required>
      </label>
      </div>

      <div class="form-group">
        <span id="spMin" class="font-weight-bold text-primary mr-1">1</span>
        <input id="days" class="col-md-5 custom-range"
          type="range" name="days" min="1" max="6" value="1">
        <span id="spMax" class="font-weight-bold text-primary">5</span>
      </div>

      <div class="form-group">
        <em>Total (&#36;):</em>
        <input id="price" type="hidden" value="<%= car.price %>">
        <input id="numbers" size="3" name="numbers"
          value="<%= car.price %>" readonly>
      </div>

      <input type="submit"
      class="col-md-6 btn btn-primary btn-block form-control" value="Reserve">
    </form>

    <% } else { %>
    <div class="price text-center">
        From:
        <em>
          <u><%=  new Date(resv.dateIn).toDateString() %></u>
        </em>
        <br />
        To:
        <em>
          <u><%= new Date(resv.dateOut).toDateString()%></u>
        </em>
    </div>

    <form action="/vehicle/edit/<%= resv.idReservation%>" method="post">
      <div class="form-group">
        <label>Date in: </label>
        <input id="dateIn" class="col-md-6 date form-control"
          type="date" name="dateIn" required>
      </div>

      <div class="form-group">
        <label>Date out: </label>
        <input id="dateOut" class="col-md-6 date form-control"
          type="date" name="dateOut" readonly required>
      </div>

      <div class="form-group">
        <span id="spMin" class="font-weight-bold text-primary mr-1">1</span>
        <input id="days" class="col-md-5 custom-range"
          type="range" name="days" min="1" max="6" value="1">
        <span id="spMax" class="font-weight-bold text-primary">5</span>
      </div>

      <div class="form-group">
        <em>Total (&#36;):</em>
        <input id="price" type="hidden" value="<%= car.price %>">
        <input id="numbers" size="3" name="numbers"
          value="<%= car.price %>" readonly>
      </div>

      <input type="submit"
        class="col-md-6 btn btn-success btn-block form-control" value="Edit">
    </form>

    <br />

    <form action="/vehicle/rem/<%= resv.idReservation%>" method="post">
      <input type="submit"
      class="col-md-6 btn btn-danger btn-block form-control" value="Remove">
    </form>
    <% } %>
  <% } %>
  </div>

  <div id="car_info" class="col-md-8 text-left card">
    <div class="model">
        <strong> <i> <%= car.brand %> <%= car.model %> </i> </strong>
    </div>

    <div class="brand"> <br>Brand:
      <a href="/data/<%= car.brand %>">
          <%= car.brand %>
      </a>
    </div>

    <div class="price"> Price:
      <%= car.price %>
      <em>&#36;</em>
    </div>

    <div class="type">
      Category:
      <a href="/data/<%= car.type %>">
          <%= car.type %>
      </a>
    </div>

    <div class="year">
      Production:
      <a href="/data/<%= car.year %>">
        <%= car.year %>
      </a>
    </div>

    <hr>

    <div class="details text-justify">
      <%= car.details %>
    </div>
  </div>
  </div>


  <%if (carsArr) { %>
  <em>
    <strong>Trending vehicles:</strong>
  </em>

  <ul class="list-unstyled pagination">
  <% carsArr.forEach( (cr) => { %>
  <li class="page-item">
    <a href="/vehicle/<%= cr.idCar%>">
      <img class="img-fluid img-thumbnail" src="/<%= cr.photo %>">
    </a>
  </li>
  <% }) %>
  </ul>
  <% }%>
</main>

<%- include('footer.ejs') %>

</body>

<script src="/js/script.js"></script>

</html>
